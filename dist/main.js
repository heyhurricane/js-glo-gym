(()=>{"use strict";(()=>{const e=document.querySelector(".club-select");let t=!1;const l=()=>{e.querySelector("ul").style.display=t?"none":"block",t=!t};document.body.addEventListener("click",(e=>{let n=e.target;n=n.closest(".club-select"),n||e.target.classList.contains("club-select__list")||e.target.classList.contains("club-select__option")||!t?n&&(n=e.target,n.classList.contains("club-select__link")||n.classList.contains("club-select__list")||n.classList.contains("club-select__option")||l()):l()}))})(),(()=>{const e=document.getElementById("free_visit_form"),t=document.querySelector(".open-popup"),l=document.querySelectorAll(".callback-btn"),n=document.getElementById("callback_form"),o=document.querySelector(".fixed-gift"),r=document.getElementById("gift"),s=document.getElementById("thanks");t.addEventListener("click",(t=>{t.preventDefault(),e.style.display="block"})),l.forEach((e=>{e.addEventListener("click",(e=>{e.preventDefault(),n.style.display="block"}))}));const c=(e,t)=>{(t.classList.contains("close_icon")||t.classList.contains("close-btn")||(t=t.closest(".overlay")))&&(e.style.display="none")};e.addEventListener("click",(t=>{let l=t.target;c(e,l)})),n.addEventListener("click",(e=>{let t=e.target;c(n,t)})),r&&(r.addEventListener("click",(e=>{let t=e.target;c(r,t)})),o.addEventListener("click",(e=>{e.preventDefault(),r.style.display="block",o.style.display="none"}))),s.addEventListener("click",(e=>{let t=e.target;c(s,t)}))})(),(()=>{const e=document.querySelector(".main-slider").querySelectorAll(".slide");let t,l=0;const n=()=>{var t,n;(t=e)[n=l].classList.remove("slide--active"),t[n].style.display="none",l++,l>=e.length&&(l=0),((e,t,l)=>{e[t].classList.add("slide--active"),e[t].style.display="flex"})(e,l)};((e=3e3)=>{t=setInterval(n,e)})(4e3)})(),(()=>{const e=document.querySelector(".services-slider"),t=e.querySelectorAll(".slide");let l=e.querySelectorAll(".slide--active"),n=5,o=0,r=0;const s=(e,t,l)=>{e[t].classList.remove(l),e[t].style.display="none"},c=(e,t,l)=>{e[t].classList.add(l),e[t].style.display="block"};e.addEventListener("click",(e=>{e.preventDefault();let l=e.target;if(l.matches(".slider-btn"))if(l.matches(".slider-btn-next")){if(r+1>=t.length)return;s(t,o,"slide--active"),o>r?r++:r=o+n,o++,o>=t.length&&(o=0),o<0&&(o=t.length-1),r<0&&(r=t.length-1),c(t,r,"slide--active")}else if(l.matches(".slider-btn-prev")){if(0===o)return;s(t,r,"slide--active"),r--,o--,o>=t.length&&(o=0),o<0&&(o=t.length-1),r<0&&(r=t.length-1),c(t,o,"slide--active")}}));const i=(l,n,o)=>{if(l.length===n)l[l.length-1].classList.remove("slide--active");else if(l.length<o)do{t[l.length].classList.add("slide--active"),l=e.querySelectorAll(".slide--active")}while(l.length<o);else if(l.length>o)do{t[l.length-1].classList.remove("slide--active"),l=e.querySelectorAll(".slide--active")}while(l.length>o)},d=e=>{window.innerWidth>992&&(n=5,i(e,6,5)),window.innerWidth<=992&&window.innerWidth>=768&&(n=4,i(e,5,4)),window.innerWidth<768&&window.innerWidth>=577&&(n=3,i(e,4,3)),window.innerWidth<=576&&window.innerWidth>=480&&(n=2,i(e,3,2)),window.innerWidth<480&&(n=1,i(e,2,1))};d(l),window.addEventListener("resize",(()=>{l=e.querySelectorAll(".slide--active"),d(l)}))})(),(()=>{const e=document.querySelector(".gallery-slider"),t=e.querySelectorAll(".slide"),l=document.querySelector(".slider-dots");for(let e=0;e<t.length;e++){const e=document.createElement("li");e.classList.add("dot"),l.append(e)}const n=document.querySelectorAll(".dot");n[0].classList.add("dot-active");let o,r=0;const s=(e,t,l)=>{e[t].classList.remove(l)},c=(e,t,l)=>{e[t].classList.add(l)},i=()=>{s(t,r,"slide--active"),s(n,r,"dot-active"),r++,r>=t.length&&(r=0),c(t,r,"slide--active"),c(n,r,"dot-active")},d=(e=3e3)=>{o=setInterval(i,e)};d(4e3),e.addEventListener("click",(e=>{e.preventDefault();let l=e.target;l.matches(".gallery-slider-btn, .dot")&&(s(t,r,"slide--active"),s(n,r,"dot-active"),l.matches(".gallery-slider-btn-next")?r++:l.matches(".gallery-slider-btn-prev")?r--:l.matches(".dot")&&n.forEach(((e,t)=>{e===l&&(r=t)})),r>=t.length&&(r=0),r<0&&(r=t.length-1),c(t,r,"slide--active"),c(n,r,"dot-active"))})),e.addEventListener("mouseover",(e=>{e.target.matches(".gallery-slider-btn, .dot")&&clearInterval(o)})),e.addEventListener("mouseout",(e=>{e.target.matches(".gallery-slider-btn, .dot")&&d(4e3)}))})(),document.querySelectorAll('[name="name"]').forEach((e=>{e.matches('[placeholder="Промокод"]')?e.addEventListener("input",(()=>{e.value=e.value.replace(/[^а-яА-Я\s\d]/gi,"")})):e.addEventListener("input",(()=>{e.value=e.value.replace(/[^а-яА-Я\s]/gi,"")}))})),((e,t="+7 (___) ___-__-__")=>{const l=document.querySelectorAll(e),n=e=>{const l=e.target,n=e.keyCode,o=t,r=o.replace(/\D/g,""),s=l.value.replace(/\D/g,"");let c=0,i=o.replace(/[_\d]/g,(function(e){return c<s.length?s.charAt(c++)||r.charAt(c):e}));c=i.indexOf("_"),-1!==c&&(i=i.slice(0,c));let d=o.substr(0,l.value.length).replace(/_+/g,(function(e){return"\\d{1,"+e.length+"}"})).replace(/[+()]/g,"\\$&");d=new RegExp("^"+d+"$"),(!d.test(l.value)||l.value.length<5||n>47&&n<58)&&(l.value=i),"blur"===e.type&&l.value.length<5&&(l.value="")};for(const e of l)e.addEventListener("input",n),e.addEventListener("focus",n),e.addEventListener("blur",n)})('[name="phone"]',"+7 (___) ___-__-__"),(()=>{const e="Что-то пошло не так...",t=document.querySelectorAll("form");let l=document.createElement("div");l.style.cssText="font-size: 2rem;";const n=(e,t,l)=>{const n=e.closest(".popup"),o=e.childNodes,r=e.querySelector("h4");r.textContent=l;for(let e=0;e<o.length;e++)"#text"!==o[e].nodeName&&"H4"!==o[e].nodeName&&"#comment"!==o[e].nodeName&&(o[e].style.display="none");const s=document.createElement("p");s.classList.add("message"),s.innerHTML=t,s.style.cssText="font-size: 20px; color: #fff; font-weight: 500;  margin-top: 30px;",e.append(s),setTimeout((()=>{n.style.display="none",o[0].innerHTML="","callback_form"===n.getAttribute("id")?r.textContent="Обратный звонок":r.textContent="Записаться на визит";for(let e=0;e<o.length;e++)"#text"!==o[e].nodeName&&"H4"!==o[e].nodeName&&"#comment"!==o[e].nodeName&&(o[e].style.display="block");e.removeChild(s)}),4e3)},o=(e,t)=>{const l=document.querySelector("#thanks");l.style.display="block";const n=l.querySelector(".form-content p"),o=l.querySelector(".form-content h4");n.innerHTML=e,o.textContent=t,setTimeout((()=>{l.style.display="none"}),4e3)};t.forEach((r=>{"footer_form"===r.getAttribute("id")&&r.addEventListener("click",(()=>{t[3].querySelector("#callback_form1-phone").value=r.querySelectorAll("input")[2].value})),r.addEventListener("submit",(t=>{t.preventDefault();const s=r.querySelectorAll("input");"form1"!==r.getAttribute("id")&&"form2"!==r.getAttribute("id")||(l.style.color="#FFF"),l.textContent="";let c=0;if(s.forEach((e=>{let t;t="form1"===r.getAttribute("id")||"card_order"===r.getAttribute("id")||"form2"===r.getAttribute("id")?document.createElement("span"):document.createElement("div");const l=t;if(l.classList.add("mistake"),"form1"===r.getAttribute("id")||"card_order"===r.getAttribute("id")||"form2"===r.getAttribute("id")?e.classList.contains("form-check")?4===e.parentNode.childNodes.length&&e.parentNode.childNodes[3].remove():2===e.parentNode.childNodes.length&&e.parentNode.childNodes[1].remove():"footer_form"===r.getAttribute("id")?(2===e.parentNode.childNodes.length&&e.parentNode.childNodes[1].remove(),5===e.parentNode.childNodes.length&&e.parentNode.childNodes[4].remove()):4===e.parentNode.childNodes.length?e.parentNode.childNodes[3].remove():e.classList.contains("form-check")&&4===e.parentNode.parentNode.childNodes.length&&e.parentNode.parentNode.childNodes[3].remove(),l.style.cssText="font-size: 1rem; color: tomato; left: 2%; bottom: -2.5rem; position: static;",window.innerWidth>=768&&"footer_form"!==r.getAttribute("id")?l.style.cssText+="position: absolute":l.style.cssText+="display: block; margin-bottom: 1rem;","form1"!==r.getAttribute("id")&&"card_order"!==r.getAttribute("id")&&"form2"!==r.getAttribute("id")||(l.style.cssText="font-size: 1rem; color: tomato; left: 2%;","card_order"===r.getAttribute("id")?l.style.cssText+="margin-left: 30px; margin-bottom: 0.5rem;":l.style.cssText+="margin-top: 0.4rem;"),e.classList.contains("form-name")&&(e.value.length<2||e.value.length>50)&&(l.textContent="Имя должно быть от 2 до 50 символов",e.parentNode.append(l),c++),e.classList.contains("form-phone")&&e.value.length<18&&("footer_form"===r.getAttribute("id")?(l.style.cssText="font-size: 1rem; color: tomato; line-height: 1.2; text-align: left; margin-bottom: 0.4rem;",l.innerHTML="Номер должен содержать<br>11 символов"):l.textContent="Номер должен содержать 11 символов",e.parentNode.append(l),c++),"club-name"===e.getAttribute("name")){const t=r.querySelectorAll('[name="club-name"]');let n=0;t.forEach((e=>{!1===e.checked&&n++})),2===n&&"footer_leto_schelkovo"===e.getAttribute("id")&&(l.textContent="Выберите клуб",e.parentNode.append(l),c++)}e.classList.contains("form-check")&&!1===e.checked&&(window.innerWidth>=768?l.style.cssText="font-size: 1rem; color: tomato; left: 0; margin-top: 0.4rem;":l.style.cssText="font-size: 1rem; color: tomato; left: 0; top: -2rem;",l.textContent="Необходимо подтвердить согласие!","check"===e.getAttribute("id")||"check2"===e.getAttribute("id")||"card_order"===r.getAttribute("id")?e.parentNode.append(l):e.parentNode.parentNode.append(l),c++)})),0===c){l.textContent="Идёт отправка...",r.append(l);const t=new FormData(r);let c={};t.forEach(((e,t)=>{c[t]=e})),(e=>fetch("./server.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}))(c).then((e=>{if(200!==e.status)throw new Error("Status network isn't 200");if(l.textContent="","banner-form"===r.getAttribute("id")||"card_order"===r.getAttribute("id")||"footer_form"===r.getAttribute("id")?o("Ваша заявка отправлена. <br> Мы свяжемся с вами в ближайшее время.","Спасибо!"):n(r,"Ваша заявка отправлена. <br> Мы свяжемся с вами в ближайшее время.","Спасибо!"),"card_order"===r.getAttribute("id")){s[0].checked=!0;for(let e=6;e<s.length;e++)(7!==e||s[e].classList.contains("form-phone-club"))&&(s[e].value="",s[e].classList.contains("form-check")&&(s[e].checked=!1))}else"footer_form"===r.getAttribute("id")?s[2].value="":s.forEach((e=>{e.value="",e.classList.contains("form-check")&&(e.checked=!1)}))})).catch((t=>{l.textContent="","banner-form"===r.getAttribute("id")||"card_order"===r.getAttribute("id")||"footer_form"===r.getAttribute("id")?o(e,"Ошибка!"):n(r,e,"Ошибка!")}))}}))}))})(),(()=>{const e=document.getElementById("card_order"),t=e.querySelectorAll('[name="card-type"]'),l=e.querySelectorAll('[name="club-name"]'),n=e.querySelector('[placeholder="Промокод"]'),o=document.getElementById("price-total"),r={mozaika:[1999,9990,13990,19990],schelkovo:[2999,14990,21990,24990]};n&&e.addEventListener("change",(e=>{const s=e.target;(s.matches('[name="club-name"]')||s.matches('[name="card-type"]')||s.matches('[placeholder="Промокод"]'))&&(()=>{for(let e=0;e<l.length;e++)if(l[e].checked)for(let s=0;s<t.length;s++)t[s].checked&&("ТЕЛО2019"===n.value?o.textContent=Math.ceil(.7*r[l[e].value][s]):o.textContent=r[l[e].value][s])})()}))})(),(()=>{const e=document.querySelectorAll(".hidden-large")[0],t=document.querySelector(".hidden-small"),l=document.querySelector(".header-main"),n=document.querySelector(".popup-menu"),o=n.querySelectorAll("ul>li>a");let r=!1;const s=()=>{n.classList.toggle("hidden-large"),n.style.display=r?"none":"flex",r=!r};window.innerWidth<768&&(e.style.display="block",t.style.display="none"),l.addEventListener("click",(e=>{let t=e.target;t=t.closest(".menu-button img"),t?s():(t=e.target,t=t.closest(".close-menu-btn"),t?s():(t=e.target,o.forEach((e=>{e===t&&s()}))))})),window.addEventListener("resize",(()=>{window.innerWidth<=768?(e.style.display="block",t.style.display="none"):(e.style.display="none",t.style.display="flex",document.querySelector(".top-menu").style.position="static")}))})(),(()=>{const e=document.getElementById("totop");e.style.display="none";const t=document.querySelector(".menu-button");window.addEventListener("scroll",(()=>{"block"===t.style.display&&(window.pageYOffset>0?null!==document.querySelector(".top-menu")&&(document.querySelector(".top-menu").style.position="fixed",document.querySelector(".top-menu").style.top="0",document.querySelector(".top-menu").style.left="0",document.querySelector(".top-menu").style.right="0"):null!==document.querySelector(".top-menu")&&(document.querySelector(".top-menu").style.position="static"));const l=document.querySelector(".header-main").scrollHeight;window.pageYOffset>=l?e.style.display="block":e.style.display="none"}))})()})();